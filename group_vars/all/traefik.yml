---

traefik_name: traefik
traefik_image: traefik:1.7.12-alpine
traefik_config_template: mytraefik.toml.j2
traefik_config_directory: "{{ common_directory_config }}/traefik/"
traefik_ports:
  - 8080:8080  # management
  - 80:80  # http
  - 443:443  # https

traefik_docker_additional_options:
  restart_policy: always
  networks: "{{ docker_networks }}"
  labels:
    traefik.port: "{{ traefik_ports[0].split(':')[0] }}"
    traefik.frontend.auth.basic.usersFile: "/htpasswd"
  volumes:
    - "{{ traefik_config_directory }}/htpasswd:/htpasswd"
    - /var/run/docker.sock:/var/run/docker.sock
    - "{{ traefik_config_directory }}/traefik.toml:/traefik.toml"
    - "{{ traefik_config_acme_file }}:/acme.json"

  env:
    CF_API_EMAIL: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          33393664353733396365313963346532376238326338336338306461326361663933333934303337
          6233356131636361363336623432323833333663313234360a383134373138376661316437396632
          61333466653862393163633539336662383965343234393163613631316433626636343666633263
          6566333162326338300a666265376362303963373132343835666437623332303131316135363639
          35316262643331643365323864343465656139643231383937353135613237343965
    CF_API_KEY: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          30643439653862303163623434653032643931353133363861396336386130386235643864646163
          6665643964356534356266366439376262663263613163380a396434643865616230336661393937
          30326237623435316335656333396132356430636233613763626539386431653932303064626362
          6433623732636436300a363961333034366663623061303535323831326161613538363666393063
          63356132353563303463363231633235313265613838663338313836323035306230356332336335
          3464633632623838363738366236336231336230356139336231
